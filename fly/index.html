<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <style>
        .emoji {
            position: absolute;
            cursor: pointer;
            font-size: 64px;
        }
    </style>
</head>

<body>
    <div id="score">Score: 0</div>
    <div id="level">Level: 1</div>
    <div id="time">Total time: 0</div> <!-- Add this line -->
    <div id="levelTime" style="color: red;">Level time: 30</div> <!-- Add this line -->

    <script>
        var score = 0;
        var selectedFly = null;
        var level = 1;
        var pooCount = 0;
        var time = 0; // Add this line
        var levelTime = 30; // Add this line
        var levelTimer; // Add this line

        // Start the time counter
        setInterval(function () {
            time++;
            document.getElementById('time').innerText = 'Time: ' + time;
        }, 1000); // Increment time every 1 second

        // Start the level timer
        startLevelTimer(); // Add this line

        // Generate flies and poos
        generateEmojis();

        function startLevelTimer() {
            levelTime = 30;
            document.getElementById('levelTime').innerText = 'Level time: ' + levelTime;
            levelTimer = setInterval(function () {
                levelTime--;
                document.getElementById('levelTime').innerText = 'Level time: ' + levelTime;
                if (levelTime === 0) {
                    clearInterval(levelTimer);
                    // Handle level timeout here
                }
            }, 1000);
        }

        function generateEmojis() {
            for (let i = 0; i < level; i++) {
                createEmoji('ðŸª°', 'fly');
                createEmoji('ðŸ’©', 'poo');
                pooCount++;
            }
        }

        function createEmoji(symbol, type) {
            var emoji = document.createElement('div');
            emoji.innerHTML = symbol;
            emoji.classList.add('emoji');
            emoji.classList.add(type);
            emoji.style.left = `${Math.random() * window.innerWidth}px`;
            emoji.style.top = `${Math.random() * window.innerHeight}px`;
            document.body.appendChild(emoji);

            if (type === 'fly') {
                emoji.addEventListener('click', function () {
                    if (!this.classList.contains('landed')) {
                        selectedFly = this;
                    }
                });
            } else {
                emoji.addEventListener('click', function () {
                    if (selectedFly) {
                        moveFlyToPoo(selectedFly, this);
                        selectedFly = null; // Reset selectedFly after moving it to a poo
                    }
                });
            }
        }

        var emojiSize = 50; // Replace with the actual size of your emojis
        emoji.style.left = `${Math.random() * (window.innerWidth - emojiSize)}px`;
        emoji.style.top = `${Math.random() * (window.innerHeight - emojiSize)}px`;

        // Assuming `emojiSize` is the size of your emojis and `placeEmoji` is the function that places them
        function placeEmoji() {
            var x = Math.random() * (window.innerWidth - emojiSize);
            var y = Math.random() * (window.innerHeight - emojiSize);
            // Place the emoji at (x, y)
        }

        function moveFlyToPoo(fly, poo) {
            var pooPosition = poo.getBoundingClientRect();
            fly.style.transition = 'all 2s';
            fly.style.left = `${pooPosition.left}px`;
            fly.style.top = `${pooPosition.top}px`;

            setTimeout(function () {
                poo.remove();
                fly.remove();
                score++;
                pooCount--;
                document.getElementById('score').innerText = 'Score: ' + score;

                if (pooCount === 0) { // Add this line
                    levelUp(); // Add this line
                }
            }, 2000);
        }

        function clearEmojis() {
            var flies = document.getElementsByClassName('fly');
            var poos = document.getElementsByClassName('poo');

            while (flies[0]) {
                flies[0].parentNode.removeChild(flies[0]);
            }

            while (poos[0]) {
                poos[0].parentNode.removeChild(poos[0]);
            }
        }

        function levelUp() {
            level++;
            document.getElementById('level').innerText = 'Level: ' + level;
            clearInterval(levelTimer);
            clearEmojis(); // Add this line
            startLevelTimer();
            generateEmojis();
        }

        var flyClicked = false;
        var pooClicked = false;

        // Assuming `poo` is the poo emoji element
        poo.addEventListener('click', function (event) {
            pooClicked = true;
            event.stopPropagation();
        });

        // Assuming `fly` is the fly emoji element
        fly.addEventListener('click', function (event) {
            if (event.target !== fly || pooClicked) {
                // The click was not on the fly or a poo was clicked before, ignore it
                pooClicked = false;
                return;
            }
        });

    </script>

</body>

</html>